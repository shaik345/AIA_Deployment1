<?xml version="1.0" encoding="UTF-8" ?>
<?oracle-xsl-mapper
  <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="WSDL">
      <schema location="../../../Bethpage%20Devops/SyncProductSiebelProvABCSImpl/SWIProductLineRef.wsdl"/>
      <rootElement name="SWIProductLine_Upsert_Output" namespace="http://siebel.com/asi/"/>
    </source>
  </mapSources>
  <mapTargets>
    <target type="XSD">
      <schema location="oramds:/apps/AIAMetaData/AIAComponents/EnterpriseObjectLibrary/Core/EBO/Item/V2/ItemEBM.xsd"/>
      <rootElement name="SyncItemListResponseEBM" namespace="http://xmlns.oracle.com/EnterpriseObjects/Core/EBO/Item/V2"/>
    </target>
  </mapTargets>
  <!-- GENERATED BY ORACLE XSL MAPPER 11.1.1.5.0(build 110418.1550.0174) AT [THU JUN 05 15:30:34 IST 2014]. -->
?>
<xsl:stylesheet version="1.0"
                xmlns:svcdoc="http://xmlns.oracle.com/Services/Documentation/V1"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
                xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xmlns:corecomEBO="http://xmlns.oracle.com/EnterpriseObjects/Core/CommonEBO/V1"
                xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
                xmlns:xsdLocal2="http://www.siebel.com/xml/SWIAdminProductLine/Data"
                xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/"
                xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
                xmlns:corecomcust="http://xmlns.oracle.com/EnterpriseObjects/Core/Custom/Common/V2"
                xmlns:ora="http://schemas.oracle.com/xpath/extension"
                xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator"
                xmlns:wsa="http://schemas.xmlsoap.org/ws/2003/03/addressing"
                xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction"
                xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
                xmlns:ns0="http://xmlns.oracle.com/EnterpriseObjects/Core/EBO/Item/V2"
                xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
                xmlns:xsdLocal3="http://www.siebel.com/xml/SWIAdminProductLine/Id"
                xmlns:med="http://schemas.oracle.com/mediator/xpath"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
                xmlns:xacml="urn:oasis:names:tc:xacml:2.0:policy:schema:cd:04"
                xmlns:coreitemcust="http://xmlns.oracle.com/EnterpriseObjects/Core/Custom/EBO/Item/V2"
                xmlns:tns="http://siebel.com/asi/"
                xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
                xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:corecom="http://xmlns.oracle.com/EnterpriseObjects/Core/Common/V2"
                xmlns:xsdLocal1="http://www.siebel.com/xml/SWIAdminProductLine"
                xmlns:xacml-context="urn:oasis:names:tc:xacml:2.0:context:schema:cd:04"
                xmlns:xsdLocal4="http://www.siebel.com/xml/SWIAdminProductLine/Query"
                xmlns:ns1="http://xmlns.oracle.com/EnterpriseObjects/Core/Custom/CommonEBO/V1"
                xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
                xmlns:str="http://www.oracle.com/XSL/Transform/java/java.lang.String"
                xmlns:orcl="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:aia="http://www.oracle.com/XSL/Transform/java/oracle.apps.aia.core.xpath.AIAFunctions"
                exclude-result-prefixes="xsi xsl xsdLocal2 soapenc soap xsdLocal3 tns xsd xsdLocal1 xsdLocal4 svcdoc corecomEBO corecomcust wsa ns0 xacml coreitemcust corecom xacml-context ns1 xp20 bpws bpel bpm ora socket mhdr oraext dvm hwf med ids xdk xref ldap">
                
                <xsl:param name="EBMHeaderParam"/>
              <xsl:param name="ReqEBMParam"/>
              
              <xsl:variable name="fixedAmpersand">&amp;amp;amp;</xsl:variable>
              <xsl:variable name="EscapedEBMHeaderVariable_fixed" select="str:replaceAll(string($EBMHeaderParam),'\u0026(amp;)*+',$fixedAmpersand)"/>
              <xsl:variable name="EBMHeaderVariable" select="orcl:parseEscapedXML($EscapedEBMHeaderVariable_fixed)"/>
                <xsl:variable name="EscapedReqEBMParam_fixed" select="str:replaceAll(string($ReqEBMParam),'\u0026(amp;)*+',$fixedAmpersand)"/>
              <xsl:variable name="EBMDataAreaVariable" select="orcl:parseEscapedXML($EscapedReqEBMParam_fixed)"/>
              
              <xsl:variable name="TargetID" select="$EBMHeaderVariable/corecom:Sender/corecom:ID"/>
              <xsl:variable name="TargetServiceName" select="$EBMHeaderVariable/corecom:Sender/corecom:WSAddress/wsa:ReplyTo/wsa:ServiceName"/>
              <xsl:variable name="systemId" select="$EBMHeaderVariable/corecom:Target/corecom:ID"/>
              <xsl:variable name="senderSystemId" select="$EBMHeaderVariable/corecom:Sender/corecom:ID"/>
              <xsl:variable name="XREFSourceCol" select="'COMMON'"/>
              
                  <xsl:template match="/">
                    <ns0:SyncItemListResponseEBM>
                    <corecom:EBMHeader>
                    <xsl:variable name="messageIDVariable" select="orcl:generate-guid()"/>
                    <corecom:EBMID>
                      <xsl:value-of select="$messageIDVariable"/>
                    </corecom:EBMID>
                    <corecom:EBMName>
                      <xsl:text disable-output-escaping="no">{http://xmlns.oracle.com/ABCSImpl/Core/Item/V2}Item}SyncItemListResponseEBM</xsl:text>
                    </corecom:EBMName>
                    <corecom:EBOName>
                      <xsl:text disable-output-escaping="no">{http://xmlns.oracle.com/ABCSImpl/Industry/Core/ItemComposition/V1}Item</xsl:text>
                    </corecom:EBOName>
                    <corecom:CreationDateTime>
                      <xsl:value-of select="xp20:current-dateTime()"/>
                    </corecom:CreationDateTime>
                    <corecom:RequestEBMID>
                      <xsl:value-of select="$EBMHeaderVariable/corecom:EBMID"/>
                    </corecom:RequestEBMID>
                    <corecom:VerbCode>
                      <xsl:text disable-output-escaping="no">Sync</xsl:text>
                    </corecom:VerbCode>
                    <corecom:MessageProcessingInstruction>
                      <xsl:variable name="ConfigServiceName" select="'{http://xmlns.oracle.com/ABCSImpl/Siebel/Core/SyncProductSiebelProvABCSImpl/V1}SyncProductSiebelProvABCSImpl'"/>
                      <xsl:variable name="RouteToCAVS" select="aia:getServiceProperty($ConfigServiceName, 'Routing.ItemResponseEBSV2.SyncItemListResponse.RouteToCAVS', false())='true'"/>
                      <corecom:EnvironmentCode>
                        <xsl:choose>
                          <xsl:when test="$RouteToCAVS">
                            <xsl:text>CAVS</xsl:text>
                          </xsl:when>
                          <xsl:otherwise>
                            <xsl:variable name="EnvCode" select="aia:getServiceProperty($ConfigServiceName, 'Routing.ItemResponseEBSV2.SyncItemListResponse.MessageProcessingInstruction.EnvironmentCode', false())"/>
                            <xsl:choose>
                              <xsl:when test="$EnvCode!=''">
                                <xsl:value-of select="$EnvCode"/>
                              </xsl:when>
                              <xsl:otherwise>
                                <xsl:text>PRODUCTION</xsl:text>
                              </xsl:otherwise>
                            </xsl:choose>
                          </xsl:otherwise>
                        </xsl:choose>
                      </corecom:EnvironmentCode>
                      <xsl:if test="$RouteToCAVS">
                        <corecom:DefinitionID>
                          <xsl:value-of select="aia:getServiceProperty($ConfigServiceName, 'Routing.ItemResponseEBSV2.SyncItemListResponse.CAVS.EndpointURI', false())"/>
                        </corecom:DefinitionID>
                      </xsl:if>
                      <corecom:InstanceID>
                        <xsl:value-of select="$EBMHeaderVariable/corecom:MessageProcessingInstruction/corecom:InstanceID"/>
                      </corecom:InstanceID>
                    </corecom:MessageProcessingInstruction>
                    <corecom:Sender>
                      <xsl:variable name="senderNodeVariable" select="aia:getEBMHeaderSenderSystemNode($systemId,'')"/>
                      <corecom:ID>
                        <xsl:value-of select="$senderNodeVariable/ID"/>
                      </corecom:ID>
                      <corecom:Description>
                        <xsl:value-of select="$senderNodeVariable/Description"/>
                      </corecom:Description>
                      <corecom:IPAddress>
                        <xsl:value-of select="$senderNodeVariable/IPAddress"/>
                      </corecom:IPAddress>
                      <corecom:CallingServiceName>
                        <xsl:text disable-output-escaping="no">ItemEBSV2</xsl:text>
                      </corecom:CallingServiceName>
                      <corecom:Application>
                        <corecom:ID>
                          <xsl:value-of select="$senderNodeVariable/Application/ID"/>
                        </corecom:ID>
                        <corecom:Version>
                          <xsl:value-of select="$senderNodeVariable/Application/Version"/>
                        </corecom:Version>
                      </corecom:Application>
                      <corecom:ContactName>
                        <xsl:value-of select="$senderNodeVariable/ContactName"/>
                      </corecom:ContactName>
                      <corecom:ContactEmail>
                        <xsl:value-of select="$senderNodeVariable/ContactEmail"/>
                      </corecom:ContactEmail>
                      <corecom:ContactPhoneNumber>
                        <xsl:value-of select="$senderNodeVariable/ContactPhone"/>
                      </corecom:ContactPhoneNumber>
                    </corecom:Sender>
                   <corecom:Target>
                       <corecom:ID> <xsl:value-of select="$TargetID"/> </corecom:ID>
                       <corecom:ServiceName>
                           <xsl:copy-of select="$TargetServiceName"/>
                        </corecom:ServiceName>
                       <corecom:ApplicationTypeCode>
                         <xsl:value-of select="aia:getSystemType($TargetID)"/>
                       </corecom:ApplicationTypeCode> 
                    </corecom:Target>        
                    <corecom:BusinessScope>
                      <xsl:variable name="processIDVariable" select="orcl:generate-guid()"/>
                      <corecom:ID/>
                      <corecom:InstanceID>
                        <xsl:text disable-output-escaping="no">EBIZ-to-Siebel-Product-Synchronization-Response</xsl:text>
                      </corecom:InstanceID>
                      <corecom:BusinessScopeTypeCode>
                        <xsl:text disable-output-escaping="no">BusinessProcessBusinessProcessMessage</xsl:text>
                      </corecom:BusinessScopeTypeCode>
                      <corecom:EnterpriseServiceName>
                        <xsl:text disable-output-escaping="no">ItemEBSItemEBS</xsl:text>
                      </corecom:EnterpriseServiceName>
                      <corecom:EnterpriseServiceOperationName>
                        <xsl:text disable-output-escaping="no">SyncSync</xsl:text>
                      </corecom:EnterpriseServiceOperationName>
                    </corecom:BusinessScope>
                    <corecom:EBMTracking>
                      <corecom:SequenceNumber>
                        <xsl:value-of select="1.0"/>
                      </corecom:SequenceNumber>
                      <corecom:ExecutionUnitName>
                        <xsl:text disable-output-escaping="no">SyncProductSiebelProvABCSImpl.bpel</xsl:text>
                      </corecom:ExecutionUnitName>
                      <corecom:ImplementationCode>
                        <xsl:text disable-output-escaping="no">BPEL</xsl:text>
                      </corecom:ImplementationCode>
                      <corecom:ActivityDateTime>
                        <xsl:value-of select="xp20:current-dateTime()"/>
                      </corecom:ActivityDateTime>
                    </corecom:EBMTracking>
                       <corecom:MessageBatch>
                        <xsl:copy-of select="$EBMHeaderVariable/corecom:MessageBatch/corecom:ID"/>
                        <xsl:copy-of select="$EBMHeaderVariable/corecom:MessageBatch/corecom:Name"/>
                        <corecom:StatusCode>Success</corecom:StatusCode>
                        <corecom:ResponseMessage/>
                    </corecom:MessageBatch>
                  </corecom:EBMHeader>
                      <ns0:DataArea>
                        <ns0:SyncItemListResponse>
                          <corecom:ItemIdentification>
                            <xsl:variable name="ProdName" select="/tns:SWIProductLine_Upsert_Output/xsdLocal1:ListOfAdminProductLine/xsdLocal1:AdminProductLine/xsdLocal1:Name"/>
                            <xsl:variable name="CommonCol">
                              <xsl:value-of select="$EBMDataAreaVariable/ns0:DataArea/ns0:SyncItemList[corecomEBO:Name=$ProdName]/corecom:ItemIdentification/corecom:BusinessComponentID"/>
                            </xsl:variable>
                            <corecom:BusinessComponentID>
                              <xsl:choose>
                               <xsl:when test="xref:lookupXRef('oramds:/apps/AIAMetaData/xref/PRODUCTLINE_ID.xref',$systemId,/tns:SWIProductLine_Upsert_Output/xsdLocal1:ListOfAdminProductLine/xsdLocal1:AdminProductLine/xsdLocal1:Id,$XREFSourceCol,false()) != ''">
                                 <xsl:value-of select="xref:lookupXRef('oramds:/apps/AIAMetaData/xref/PRODUCTLINE_ID.xref',$systemId,/tns:SWIProductLine_Upsert_Output/xsdLocal1:ListOfAdminProductLine/xsdLocal1:AdminProductLine/xsdLocal1:Id,$XREFSourceCol,false())"/>
                               </xsl:when>
                               <xsl:otherwise>
                                 <xsl:value-of select="xref:populateXRefRow('oramds:/apps/AIAMetaData/xref/PRODUCTLINE_ID.xref',$XREFSourceCol,$CommonCol,$systemId,/tns:SWIProductLine_Upsert_Output/xsdLocal1:ListOfAdminProductLine/xsdLocal1:AdminProductLine/xsdLocal1:Id,'ANY')"/>
                                 <xsl:value-of select="/tns:SWIProductLine_Upsert_Output/xsdLocal1:ListOfAdminProductLine/xsdLocal1:AdminProductLine/xsdLocal1:Id"/>
                               </xsl:otherwise>
                              </xsl:choose>
                            </corecom:BusinessComponentID>
                          </corecom:ItemIdentification>
                        </ns0:SyncItemListResponse>
                      </ns0:DataArea>
                    </ns0:SyncItemListResponseEBM>
                  </xsl:template>
</xsl:stylesheet>
